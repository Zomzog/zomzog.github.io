<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Springboot embeded flowable" />
<meta property="og:description" content="
In this tutorial, we&#8217;ll see how to initiate a springboot project with flowable.


We will build an API to make a pony says &#34;hello &lt;name&gt;&#34; or &#34;Eeyup&#34; if the pony is Big McIntosh
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zomzog.fr/2017/11/springboot-embeded-flowable/" />
<meta property="article:published_time" content="2017-11-01T21:49:21+01:00" />
<meta property="article:modified_time" content="2017-11-01T21:49:21+01:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Springboot embeded flowable"/>
<meta name="twitter:description" content="
In this tutorial, we&#8217;ll see how to initiate a springboot project with flowable.


We will build an API to make a pony says &#34;hello &lt;name&gt;&#34; or &#34;Eeyup&#34; if the pony is Big McIntosh
"/>
<meta name="generator" content="Hugo 0.74.3" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Springboot embeded flowable",
  "url": "https:\/\/zomzog.fr\/2017\/11\/springboot-embeded-flowable\/",
  "wordCount": "1008",
  "datePublished": "2017-11-01T21:49:21\u002b01:00",
  "dateModified": "2017-11-01T21:49:21\u002b01:00",
  "author": {
    "@type": "Person",
    "name": "Thibault Duperron"
  },
  "keywords": "Java, BPM, Flowabe, SpringBoot"
}
</script>



    <link rel="canonical" href="https://zomzog.fr/2017/11/springboot-embeded-flowable/">
    
      <script src="https://zomzog.fr/js/jquery.js"></script>
      <script src="https://zomzog.fr/js/popper.js"></script>
      <script src="https://zomzog.fr/js/bootstrap.js"></script>
    

    <title>Springboot embeded flowable | Zomzog&#39;s blog</title>

    <!-- combined, minified CSS -->
    <link href="https://zomzog.fr/css/style.css" rel="stylesheet">

    

    

    

    

  </head>

  <body>

    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link " href="https://zomzog.fr/">Zomzog's blog</a>
          
          
        </nav>
      </div>
    </div>

    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title"><a href="https://zomzog.fr/" rel="home"></a></h1>
        
      </div>
    </header>

    <div class="container">
      <div class="row">
        <div class="col-12 col-md-9 col-lg-9 blog-main">

          


<article class="blog-post">
    <section class="timeline"><a href="https://zomzog.fr/2017/12/prestashop-1.7-module/"><i class="fa fa-long-arrow-left" aria-hidden="true"></i> Prestashop 1.7 module</a><div></div><br>
</section>
  <header>
    <h2 class="blog-post-title">
      <a href="https://zomzog.fr/2017/11/springboot-embeded-flowable/">Springboot embeded flowable</a>
      <a class="edit" href="https://github.com/zomzog/zomzog.fr/edit/master/content/post/articles/springboot-embeded-flowable.adoc"><i class="fa fa-pencil" aria-hidden="true"></i></a>
    </h2>
    <p class="blog-post-meta"><time datetime="2017-11-01T21:49:21&#43;01:00">Wed 01 Nov 2017</time> by Thibault Duperron in 

<i class="fa fa-tag" aria-hidden="true"></i>&nbsp;<a href="/tags/java" rel="tag">Java</a>, <a href="/tags/bpm" rel="tag">BPM</a>, <a href="/tags/flowabe" rel="tag">Flowabe</a>, <a href="/tags/springboot" rel="tag">SpringBoot</a>

</p>
  </header>
  <div class="paragraph">
<p>In this tutorial, we&#8217;ll see how to initiate a springboot project with flowable.</p>
</div>
<div class="paragraph">
<p>We will build an API to make a pony says "hello &lt;name&gt;" or "Eeyup" if the pony is Big McIntosh</p>
</div>
<div class="paragraph">
<p>The full implementation of this tutorial can be found in
<a href="https://github.com/Zomzog/embedded-flowable">this github project</a>.</p>
</div>
<div class="sect1">
<h2 id="_dependencies">Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We will need :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for springboot : web, data-jpa, test</p>
</li>
<li>
<p>for flowable : flowable-spring-boot-starter-basic</p>
</li>
<li>
<p>for database : h2</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="accordion">
  <h5>
    <a class="collapsed" data-toggle="collapse" href="#mvn" role="button" aria-expanded="false" aria-controls="mvn">
        <i class="fa fa-caret-down" aria-hidden="true"></i>
        Maven configuration
    </a>
  </h5>
  <div class="collapse" id="mvn">
    
	<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">		<span style="color:#f92672">&lt;parent&gt;</span>
			<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
			<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-parent<span style="color:#f92672">&lt;/artifactId&gt;</span>
			<span style="color:#f92672">&lt;version&gt;</span>1.5.8.RELEASE<span style="color:#f92672">&lt;/version&gt;</span>
			<span style="color:#f92672">&lt;relativePath/&gt;</span> <span style="color:#75715e">&lt;!-- lookup parent from repository --&gt;</span>
		<span style="color:#f92672">&lt;/parent&gt;</span>

		<span style="color:#f92672">&lt;properties&gt;</span>
			<span style="color:#f92672">&lt;java.version&gt;</span>1.8<span style="color:#f92672">&lt;/java.version&gt;</span>
			<span style="color:#f92672">&lt;flowable.version&gt;</span>6.2.0<span style="color:#f92672">&lt;/flowable.version&gt;</span>
		<span style="color:#f92672">&lt;/properties&gt;</span>
		
		<span style="color:#f92672">&lt;dependencies&gt;</span>
			<span style="color:#75715e">&lt;!-- Springboot --&gt;</span>
			<span style="color:#f92672">&lt;dependency&gt;</span>
				<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
				<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-web<span style="color:#f92672">&lt;/artifactId&gt;</span>
			<span style="color:#f92672">&lt;/dependency&gt;</span>
			<span style="color:#f92672">&lt;dependency&gt;</span>
				<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
				<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-data-jpa<span style="color:#f92672">&lt;/artifactId&gt;</span>
			<span style="color:#f92672">&lt;/dependency&gt;</span>

			<span style="color:#75715e">&lt;!-- Flowabe --&gt;</span>
			<span style="color:#f92672">&lt;dependency&gt;</span>
				<span style="color:#f92672">&lt;groupId&gt;</span>org.flowable<span style="color:#f92672">&lt;/groupId&gt;</span>
				<span style="color:#f92672">&lt;artifactId&gt;</span>flowable-spring-boot-starter-basic<span style="color:#f92672">&lt;/artifactId&gt;</span>
				<span style="color:#f92672">&lt;version&gt;</span>${flowable.version}<span style="color:#f92672">&lt;/version&gt;</span>
			<span style="color:#f92672">&lt;/dependency&gt;</span>
			
			<span style="color:#75715e">&lt;!-- Database --&gt;</span>
			<span style="color:#f92672">&lt;dependency&gt;</span>
				<span style="color:#f92672">&lt;groupId&gt;</span>com.h2database<span style="color:#f92672">&lt;/groupId&gt;</span>
				<span style="color:#f92672">&lt;artifactId&gt;</span>h2<span style="color:#f92672">&lt;/artifactId&gt;</span>
				<span style="color:#f92672">&lt;scope&gt;</span>runtime<span style="color:#f92672">&lt;/scope&gt;</span>
			<span style="color:#f92672">&lt;/dependency&gt;</span>

			<span style="color:#75715e">&lt;!-- Test --&gt;</span>
			<span style="color:#f92672">&lt;dependency&gt;</span>
				<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
				<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-test<span style="color:#f92672">&lt;/artifactId&gt;</span>
				<span style="color:#f92672">&lt;scope&gt;</span>test<span style="color:#f92672">&lt;/scope&gt;</span>
			<span style="color:#f92672">&lt;/dependency&gt;</span>
		<span style="color:#f92672">&lt;/dependencies&gt;</span>
		
		<span style="color:#f92672">&lt;build&gt;</span>
			<span style="color:#f92672">&lt;plugins&gt;</span>
				<span style="color:#f92672">&lt;plugin&gt;</span>
					<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
					<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
				<span style="color:#f92672">&lt;/plugin&gt;</span>
			<span style="color:#f92672">&lt;/plugins&gt;</span>
		<span style="color:#f92672">&lt;/build&gt;</span>
	</code></pre></td></tr></table>
</div>
</div>

  </div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_goals">Goals</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We want to resolve those two tests :</p>
</div>
<div class="paragraph">
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@RunWith</span><span style="color:#f92672">(</span>SpringRunner<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
<span style="color:#a6e22e">@SpringBootTest</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PonyControllerTest</span> <span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Before</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        MockitoAnnotations<span style="color:#f92672">.</span><span style="color:#a6e22e">initMocks</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">final</span> PonyController ponyController <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PonyController<span style="color:#f92672">(</span>runtimeService<span style="color:#f92672">,</span> historyService<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">mockMvc</span> <span style="color:#f92672">=</span> MockMvcBuilders<span style="color:#f92672">.</span><span style="color:#a6e22e">standaloneSetup</span><span style="color:#f92672">(</span>ponyController<span style="color:#f92672">)</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">build</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Test</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sayHello</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
        <span style="color:#75715e">// Init
</span><span style="color:#75715e"></span>        Pony pony <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Pony<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Daring Do&#34;</span><span style="color:#f92672">);</span>
        pony <span style="color:#f92672">=</span> ponyRepository<span style="color:#f92672">.</span><span style="color:#a6e22e">save</span><span style="color:#f92672">(</span>pony<span style="color:#f92672">);</span>
        <span style="color:#75715e">// Do
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">mockMvc</span><span style="color:#f92672">.</span><span style="color:#a6e22e">perform</span><span style="color:#f92672">(</span>post<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/ponies/{ponyId}/sayHello&#34;</span><span style="color:#f92672">,</span> pony<span style="color:#f92672">.</span><span style="color:#a6e22e">getId</span><span style="color:#f92672">()))</span>
                <span style="color:#75715e">// Validate
</span><span style="color:#75715e"></span>                <span style="color:#f92672">.</span><span style="color:#a6e22e">andExpect</span><span style="color:#f92672">(</span>status<span style="color:#f92672">().</span><span style="color:#a6e22e">isOk</span><span style="color:#f92672">())</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">andExpect</span><span style="color:#f92672">(</span>jsonPath<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;$.message&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">value</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Hello Daring Do&#34;</span><span style="color:#f92672">));</span>
        <span style="color:#75715e">// Teardown
</span><span style="color:#75715e"></span>        ponyRepository<span style="color:#f92672">.</span><span style="color:#a6e22e">delete</span><span style="color:#f92672">(</span>pony<span style="color:#f92672">.</span><span style="color:#a6e22e">getId</span><span style="color:#f92672">());</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Test</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sayEeyup</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
        <span style="color:#75715e">// Init
</span><span style="color:#75715e"></span>        Pony pony <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Pony<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Big McIntosh&#34;</span><span style="color:#f92672">);</span>
        pony <span style="color:#f92672">=</span> ponyRepository<span style="color:#f92672">.</span><span style="color:#a6e22e">save</span><span style="color:#f92672">(</span>pony<span style="color:#f92672">);</span>
        <span style="color:#75715e">// Do
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">mockMvc</span><span style="color:#f92672">.</span><span style="color:#a6e22e">perform</span><span style="color:#f92672">(</span>post<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/ponies/{ponyId}/sayHello&#34;</span><span style="color:#f92672">,</span> pony<span style="color:#f92672">.</span><span style="color:#a6e22e">getId</span><span style="color:#f92672">()))</span>
                <span style="color:#75715e">// Validate
</span><span style="color:#75715e"></span>                <span style="color:#f92672">.</span><span style="color:#a6e22e">andExpect</span><span style="color:#f92672">(</span>status<span style="color:#f92672">().</span><span style="color:#a6e22e">isOk</span><span style="color:#f92672">())</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">andExpect</span><span style="color:#f92672">(</span>jsonPath<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;$.message&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">value</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Eeyup&#34;</span><span style="color:#f92672">));</span>
        <span style="color:#75715e">// Teardown
</span><span style="color:#75715e"></span>        ponyRepository<span style="color:#f92672">.</span><span style="color:#a6e22e">delete</span><span style="color:#f92672">(</span>pony<span style="color:#f92672">.</span><span style="color:#a6e22e">getId</span><span style="color:#f92672">());</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_domain_model">Domain model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We will create all required class for our domain.
All objects used on a workflow must implement Serializable.
We will use two models, an entity Pony with an id and a name and an object message with is content.</p>
</div>
<div class="paragraph">
<p>Pony.java
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Entity</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Pony</span> <span style="color:#66d9ef">implements</span> Serializable  <span style="color:#f92672">{</span>

	<span style="color:#a6e22e">@Id</span>
	<span style="color:#a6e22e">@GeneratedValue</span><span style="color:#f92672">(</span>strategy <span style="color:#f92672">=</span> GenerationType<span style="color:#f92672">.</span><span style="color:#a6e22e">IDENTITY</span><span style="color:#f92672">)</span>
	<span style="color:#66d9ef">private</span> Long id<span style="color:#f92672">;</span>

	<span style="color:#a6e22e">@NotNull</span>
	<span style="color:#66d9ef">private</span> String name<span style="color:#f92672">;</span>

	<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Pony</span><span style="color:#f92672">(</span>String name<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> name<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></td></tr></table>
</div>
</div></p>
</div>
<div class="paragraph">
<p>Message.java
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Message</span> <span style="color:#66d9ef">implements</span> Serializable <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">private</span> String message<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span></code></pre></td></tr></table>
</div>
</div></p>
</div>
<div class="paragraph">
<p>PonyRepository.java
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">PonyRepository</span> <span style="color:#66d9ef">extends</span> JpaRepository<span style="color:#f92672">&lt;</span>Pony<span style="color:#f92672">,</span> Long<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span> <span style="color:#f92672">}</span></code></pre></td></tr></table>
</div>
</div></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_services">Services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We will need three methods on PonyService :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One to get a pony</p>
</li>
<li>
<p>One to make the pony say "Eeyup"</p>
</li>
<li>
<p>One to make the pony say "Hello {{ponyName}}"</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Service</span>
<span style="color:#a6e22e">@Transactional</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PonyService</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">private</span> PonyRepository ponyRepository<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">PonyService</span><span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> PonyRepository ponyRepository<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ponyRepository</span> <span style="color:#f92672">=</span> ponyRepository<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> Pony <span style="color:#a6e22e">getOne</span><span style="color:#f92672">(</span><span style="color:#66d9ef">long</span> id<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> FunctionalException <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> ponyRepository<span style="color:#f92672">.</span><span style="color:#a6e22e">findOne</span><span style="color:#f92672">(</span>id<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> Message <span style="color:#a6e22e">sayEeyup</span><span style="color:#f92672">(){</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Message<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Eeyup&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> Message <span style="color:#a6e22e">sayHello</span><span style="color:#f92672">(</span>Pony pony<span style="color:#f92672">){</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Message<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Hello &#34;</span> <span style="color:#f92672">+</span> pony<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">());</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_workflow">Workflow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now we will build the workflow.
It will be pretty simple we will have :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <strong>StartEvent</strong> as an entry point of the workflow</p>
</li>
<li>
<p>a <strong>ServiceTask</strong> to get the pony by calling PonyService#getOne</p>
</li>
<li>
<p>an <strong>ExclusiveGateway</strong> which will lead to :</p>
<div class="ulist">
<ul>
<li>
<p>if the pony is Big McIntosh a <strong>ServiceTask</strong> which will call PonyService#sayEeyup</p>
</li>
<li>
<p>or else a <strong>ServiceTask</strong> which will call PonyService#sayHello</p>
</li>
</ul>
</div>
</li>
<li>
<p>an <strong>EndEvent</strong> to end the workflow</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_startevent">StartEvent</h3>
<div class="paragraph">
<p>The StartEvent also called "None Start Event" is a default start event. It will be used when we will start the workflow through the API.</p>
</div>
</div>
<div class="sect2">
<h3 id="_servicetask">ServiceTask</h3>
<div class="paragraph">
<p>ServiceTask has a three-way to call a java :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java class where one JavaDelegate = 1 function</p>
</li>
<li>
<p>Expression where we can call beans</p>
</li>
<li>
<p>Delegate expression when we need to do for example field injection</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In our case, we will use Expression.
With Expression we will be able to call a bean method with ${myBean.method(variable)}</p>
</div>
<div class="paragraph">
<p>We will use resultVariableName to store the return of the method to a workflow variable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_exclusivegateway">ExclusiveGateway</h3>
<div class="paragraph">
<p>An ExclusiveGateway will work like a switch with break on each case.
Sequence flow condition will be evaluates one by one and the first one with an evaluation to true will be used.
If no condition is resolved as true, it will follow the default flow (which must have no condition).</p>
</div>
</div>
<div class="sect2">
<h3 id="_endevent">EndEvent</h3>
<div class="paragraph">
<p>An EndEvent (also called None End Event) will terminate the workflow as success.
The execution of the workflow will be stopped.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bpmn_file">BPMN file</h3>
<div class="paragraph">
<p>The .bpmn open on text editor will look like :</p>
</div>
<div class="paragraph">
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style="color:#f92672">&lt;definitions</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://www.omg.org/spec/BPMN/20100524/MODEL&#34;</span> <span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#a6e22e">xmlns:xsd=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema&#34;</span> <span style="color:#a6e22e">xmlns:activiti=</span><span style="color:#e6db74">&#34;http://activiti.org/bpmn&#34;</span> <span style="color:#a6e22e">xmlns:bpmndi=</span><span style="color:#e6db74">&#34;http://www.omg.org/spec/BPMN/20100524/DI&#34;</span> <span style="color:#a6e22e">xmlns:omgdc=</span><span style="color:#e6db74">&#34;http://www.omg.org/spec/DD/20100524/DC&#34;</span> <span style="color:#a6e22e">xmlns:omgdi=</span><span style="color:#e6db74">&#34;http://www.omg.org/spec/DD/20100524/DI&#34;</span> <span style="color:#a6e22e">xmlns:tns=</span><span style="color:#e6db74">&#34;http://www.activiti.org/test&#34;</span> <span style="color:#a6e22e">typeLanguage=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema&#34;</span> <span style="color:#a6e22e">expressionLanguage=</span><span style="color:#e6db74">&#34;http://www.w3.org/1999/XPath&#34;</span> <span style="color:#a6e22e">targetNamespace=</span><span style="color:#e6db74">&#34;http://www.zomzog.fr/blog&#34;</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;m1511380610321&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">&gt;</span>
  <span style="color:#f92672">&lt;process</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;sayHello&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Say hello process&#34;</span> <span style="color:#a6e22e">isExecutable=</span><span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#a6e22e">isClosed=</span><span style="color:#e6db74">&#34;false&#34;</span> <span style="color:#a6e22e">processType=</span><span style="color:#e6db74">&#34;None&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;startEvent</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;startevent1&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Start&#34;</span><span style="color:#f92672">&gt;&lt;/startEvent&gt;</span>
    <span style="color:#f92672">&lt;endEvent</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;endevent1&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;End&#34;</span><span style="color:#f92672">&gt;&lt;/endEvent&gt;</span>
    <span style="color:#f92672">&lt;serviceTask</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getPonyDetails&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Get pony details&#34;</span> <span style="color:#a6e22e">activiti:expression=</span><span style="color:#e6db74">&#34;${ponyService.getOne(ponyId)}&#34;</span> <span style="color:#a6e22e">activiti:resultVariableName=</span><span style="color:#e6db74">&#34;pony&#34;</span><span style="color:#f92672">&gt;&lt;/serviceTask&gt;</span>
    <span style="color:#f92672">&lt;serviceTask</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;sayEeyup&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Say Eeyup&#34;</span> <span style="color:#a6e22e">activiti:expression=</span><span style="color:#e6db74">&#34;${ponyService.sayEeyup()}&#34;</span> <span style="color:#a6e22e">activiti:resultVariableName=</span><span style="color:#e6db74">&#34;result&#34;</span><span style="color:#f92672">&gt;&lt;/serviceTask&gt;</span>
    <span style="color:#f92672">&lt;serviceTask</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;sayHello&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Say Hello&#34;</span> <span style="color:#a6e22e">activiti:expression=</span><span style="color:#e6db74">&#34;${ponyService.sayHello(pony)}&#34;</span> <span style="color:#a6e22e">activiti:resultVariableName=</span><span style="color:#e6db74">&#34;result&#34;</span><span style="color:#f92672">&gt;&lt;/serviceTask&gt;</span>
    <span style="color:#f92672">&lt;sequenceFlow</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;flow1&#34;</span> <span style="color:#a6e22e">sourceRef=</span><span style="color:#e6db74">&#34;startevent1&#34;</span> <span style="color:#a6e22e">targetRef=</span><span style="color:#e6db74">&#34;getPonyDetails&#34;</span><span style="color:#f92672">&gt;&lt;/sequenceFlow&gt;</span>
    <span style="color:#f92672">&lt;exclusiveGateway</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;exclusivegateway1&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Exclusive Gateway&#34;</span> <span style="color:#a6e22e">default=</span><span style="color:#e6db74">&#34;flow4&#34;</span><span style="color:#f92672">&gt;&lt;/exclusiveGateway&gt;</span>
    <span style="color:#f92672">&lt;sequenceFlow</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;flow2&#34;</span> <span style="color:#a6e22e">sourceRef=</span><span style="color:#e6db74">&#34;getPonyDetails&#34;</span> <span style="color:#a6e22e">targetRef=</span><span style="color:#e6db74">&#34;exclusivegateway1&#34;</span><span style="color:#f92672">&gt;&lt;/sequenceFlow&gt;</span>
    <span style="color:#f92672">&lt;sequenceFlow</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;flow3&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Big McIntosh&#34;</span> <span style="color:#a6e22e">sourceRef=</span><span style="color:#e6db74">&#34;exclusivegateway1&#34;</span> <span style="color:#a6e22e">targetRef=</span><span style="color:#e6db74">&#34;sayEeyup&#34;</span><span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;conditionExpression</span> <span style="color:#a6e22e">xsi:type=</span><span style="color:#e6db74">&#34;tFormalExpression&#34;</span><span style="color:#f92672">&gt;</span><span style="color:#75715e">&lt;![CDATA[${pony.name == &#39;Big McIntosh&#39;}]]&gt;</span><span style="color:#f92672">&lt;/conditionExpression&gt;</span>
    <span style="color:#f92672">&lt;/sequenceFlow&gt;</span>
    <span style="color:#f92672">&lt;sequenceFlow</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;flow4&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Default&#34;</span> <span style="color:#a6e22e">sourceRef=</span><span style="color:#e6db74">&#34;exclusivegateway1&#34;</span> <span style="color:#a6e22e">targetRef=</span><span style="color:#e6db74">&#34;sayHello&#34;</span><span style="color:#f92672">&gt;&lt;/sequenceFlow&gt;</span>
    <span style="color:#f92672">&lt;sequenceFlow</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;flow5&#34;</span> <span style="color:#a6e22e">sourceRef=</span><span style="color:#e6db74">&#34;sayEeyup&#34;</span> <span style="color:#a6e22e">targetRef=</span><span style="color:#e6db74">&#34;endevent1&#34;</span><span style="color:#f92672">&gt;&lt;/sequenceFlow&gt;</span>
    <span style="color:#f92672">&lt;sequenceFlow</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;flow6&#34;</span> <span style="color:#a6e22e">sourceRef=</span><span style="color:#e6db74">&#34;sayHello&#34;</span> <span style="color:#a6e22e">targetRef=</span><span style="color:#e6db74">&#34;endevent1&#34;</span><span style="color:#f92672">&gt;&lt;/sequenceFlow&gt;</span>
  <span style="color:#f92672">&lt;/process&gt;</span>
<span style="color:#f92672">&lt;/definitions&gt;</span></code></pre></td></tr></table>
</div>
</div>
</div>
<div class="paragraph">
<p>All bpmn files on src/main/resources/processes are automatically deployed on server startup.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rest">Rest</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We now need rest endpoints for start the process.
We need to create the map of variables which will be used by the process.
We will start the process by using the flowable runtimeService.
And at the end, we will use the historyService to access to the ended process variables.</p>
</div>
<div class="paragraph">
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@RestController</span>
<span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/ponies&#34;</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PonyController</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">private</span> RuntimeService runtimeService<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> HistoryService historyService<span style="color:#f92672">;</span>

    <span style="color:#a6e22e">@PostMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/{ponyId}/sayHello&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">public</span> ResponseEntity<span style="color:#f92672">&lt;</span>Message<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">sayHello</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@PathVariable</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ponyId&#34;</span><span style="color:#f92672">)</span> Long ponyId<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Object<span style="color:#f92672">&gt;</span> variables <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">&lt;&gt;();</span>
        variables<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ponyId&#34;</span><span style="color:#f92672">,</span> ponyId<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">final</span> ProcessInstance process <span style="color:#f92672">=</span> runtimeService<span style="color:#f92672">.</span><span style="color:#a6e22e">startProcessInstanceByKey</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;sayHello&#34;</span><span style="color:#f92672">,</span> variables<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">final</span> HistoricVariableInstance hvi <span style="color:#f92672">=</span> historyService<span style="color:#f92672">.</span><span style="color:#a6e22e">createHistoricVariableInstanceQuery</span><span style="color:#f92672">()</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">processInstanceId</span><span style="color:#f92672">(</span>process<span style="color:#f92672">.</span><span style="color:#a6e22e">getId</span><span style="color:#f92672">())</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">variableName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;result&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">singleResult</span><span style="color:#f92672">();</span>
        Message message <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>Message<span style="color:#f92672">)</span> hvi<span style="color:#f92672">.</span><span style="color:#a6e22e">getValue</span><span style="color:#f92672">();</span>
        <span style="color:#66d9ef">return</span> ResponseEntity<span style="color:#f92672">.</span><span style="color:#a6e22e">ok</span><span style="color:#f92672">(</span>message<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>

  

  
  <hr>
  <footer>
    <section class="timeline"><a href="https://zomzog.fr/2017/12/prestashop-1.7-module/"><i class="fa fa-long-arrow-left" aria-hidden="true"></i> Prestashop 1.7 module</a><div></div><br>
</section>

  
    <section>
    <h4>Share</h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fzomzog.fr%2f2017%2f11%2fspringboot-embeded-flowable%2f" title="Share on Facebook"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://plus.google.com/share?url=https%3a%2f%2fzomzog.fr%2f2017%2f11%2fspringboot-embeded-flowable%2f" title="Share on Google+"><span class="fa fa-google-plus fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fzomzog.fr%2f2017%2f11%2fspringboot-embeded-flowable%2f" title="Share on LinkedIn"><span class="fa fa-linkedin fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/home?status=https%3a%2f%2fzomzog.fr%2f2017%2f11%2fspringboot-embeded-flowable%2f" title="Tweet this"><span class="fa fa-twitter fa-2x"></span></a>
    </nav>
  </section>

  

  
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "zomzog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  
  </footer>
  

</article> 



        </div> <!-- /.blog-main -->
        
        
        <div class="col-12 col-lg-3">
          <aside class="ml-auto blog-sidebar">
  
  <section class="sidebar-module sidebar-module-inset row">
    <div id="profile" class="col-4 col-lg-12">
      <div class="portrait" style="background-image: url('https://s.gravatar.com/avatar/0a71ca60d71fa5dcefb541ad69d02a41?s=200');"></div>
      <meta itemprop="image" content="https://s.gravatar.com/avatar/0a71ca60d71fa5dcefb541ad69d02a41?s=200">
    </div>
    <div class="col-8 col-lg-12">
      <p>Hi, I&rsquo;m Thibault Duperron a simple developer, evangelist of the Pony Driven Development.</p>
      <p><ul id="social">
                                     
</ul></p>
    </div>
    
  </section>
  

  
        <section class="sidebar-module sidebar-module-inset row">
    <h4>Recent Posts</h4>
    <ol class="list-unstyled">


<li><a href="/2020/05/openapi-generator-inheritance/">OpenApi generator inheritance</a></li>

<li><a href="/2020/03/ergodox-accent-without-international-deadkey/">Ergodox accent without international deadkey</a></li>

<li><a href="/2020/03/openapi-generator-client-auth-token-management/">OpenApi generator client auth token management</a></li>

<li><a href="/2019/12/gitflow-maven-jgitver/">Gitflow + Maven = JgitVer</a></li>

<li><a href="/2019/12/contract-first/">Contract-First</a></li>

    </ol>
  </section>

  

</aside>

        </div>
        
        <!-- /.sidebar -->

      </div> <!-- /.row -->
    </div> <!-- /.container -->

    <footer class="blog-footer">
      <p>
      
      All code and content for this blog is available as <a href="https://github.com/zomzog/zomzog.fr">open source on GitHub</a>.
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>

  </body>

</html>
